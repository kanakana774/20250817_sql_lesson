下記テーブル定義をもとにpostgresql勉強用の問題集を50問ほどmd形式で出力してください。
実務で非常に重要となる、結合（JOIN）、集計（GROUP BY）、サブクエリ、ウィンドウ関数、集合演算子（UNION/INTERSECT）の5つの要素を複合的に使用する問題に焦点を当ててください。
必ず問題には回答を付けて、もし回答が複数パターンあれば別パターンも記載してください。
また、関数名を知らないと解けないような問題にはヒントを付けて、自分で調べて解けるようにしてください。


